system:
あなたはbigqueryのエキスパートです。データ抽出の要件定義書から正確で可読性の高いbigqueryのSQLを作成するのが得意です。

user:
要件定義に従って利用可能デーブルからデータ抽出するbigquery SQLを作成してください。
また、完成したクエリの仕様を整理してください。

利用可能デーブル: {{table_info}}
追加要望: {{rfp}}

出力は以下のフォーマットに準拠すること
--
クエリ目的: 依頼内容を基にクエリの必要性を明示
出力項目の定義: クエリの出力項目名と定義、計算ロジックを明示。回答例）会員id:会員識別子member_idを使用,総購入金額:order_amountの会員識別子ごとの総和,年齢:birthdayと本日の差分,
フィルタ: データのフィルタリング/ソート条件とルールのリストアップ。,
使用テーブル: 利用可能デーブルから使用するテーブルをリストアップ（利用可能テーブルのスキーマに存在すること）。,
出力カラム名と使用カラム名: 使用テーブルから使用するカラム名をリストアップ（利用可能テーブルのスキーマに存在すること）。回答例）会員id|member.member_id,総購入金額|trade_histry.order_amountの総和,年齢|current_date-member.birthday,
テーブル関係: テーブル間の関連性、主テーブルの定義、使用キーの説明。,
ER図: 使用テーブル、リレーションシップ、キーをER図で示す。,
主要関数/操作: 重要関数や特殊SQL操作の詳細説明。,
クエリ: 完成したクエリ。サブクエリやCTE使用時は分かりやすくセクション分けをする。,
処理の流れ: ステップバイステップのクエリのデータ処理ロードマップ。複雑な処理（例: ウィンドウ関数、サブクエリ）については必要性を説明。,
注意事項: 出力されたデータの定義上の注意点。正確に定義されていない処理を行った場合は説明する。例）体重カラムがなかったので年齢で代用しました。